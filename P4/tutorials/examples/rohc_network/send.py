#!/usr/bin/python

# Copyright 2013-present Barefoot Networks, Inc. 
# 
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
# 
#    http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.


# Packet capture from : https://wiki.wireshark.org/SampleCaptures?action=AttachFile&do=get&target=rtps_cooked.pcapng

#############################################################################
# 															Packet 1																		#
#																																						#
#	0000   FF FF FF FF FF FF 00 08 74 d8 8a f8 08 00 45 00  ..............E.	#
#	0010   00 40 0e 0d 00 00 80 11 ab 44 c0 a8 00 05 c0 a8  .@.......D......	#
#	0020   00 06 09 be 27 10 00 2c b7 f9 52 54 50 53 01 03  ....'..,..RTPS..	#
#	0030   00 00 00 00 00 00 00 01 09 01 0c 01 10 00 c8 a0  ................	#
#	0040   00 05 01 00 01 06 12 34 56 78 de ad ba be        .......4Vx....		#
#																																						#
#############################################################################

#############################################################################
# 															Packet 2																		#
#																																						#
#	0000   FF FF FF FF FF FF 00 08 74 d8 8a f8 08 00 45 00  ..............E.	#
#	0010   00 67 7b 40 00 00 80 11 3d ea c0 a8 00 05 c0 a8  .g{@....=.......	#
#	0020   00 06 0a 2c 27 10 00 53 5b 48 52 54 50 53 01 03  ...,'..S[HRTPS..	#
#	0030   00 00 00 00 00 00 00 01 09 01 08 01 ed 58 93 4e  .............X.N	#
#	0040   4e d4 d2 d4 15 05 00 00 00 00 10 00 00 00 00 00  N...............	#
#	0050   00 00 01 02 00 00 00 00 02 00 00 00 00 01 00 00  ................	#
#	0060   0f 00 00 00 43 6f 6d 69 63 20 42 6f 6f 6b 20 47  ....Comic Book G	#
#	0070   75 79 00 cd 07                                   uy...							#
#																																						#
#############################################################################

#############################################################################
# 															Packet 3																		#
#																																						#
#	0000   FF FF FF FF FF FF 00 08 74 d8 8a f8 08 00 45 00  ..............E.	#
#	0010   00 38 a9 2f 00 00 80 11 10 2a c0 a8 00 05 c0 a8  .8./.....*......	#
#	0020   00 06 0b 2b 27 10 00 24 f1 95 52 54 50 53 01 03  ...+'..$..RTPS..	#
#	0030   00 00 00 00 00 00 00 01 09 01 09 00 00 08 c5 02  ................	#
#	0040   04 ec ec 42 ee 92                                ...B..						#
#																																						#
#############################################################################

#############################################################################
# 															Packet 4																		#
#																																						#
#	0000   FF FF FF FF FF FF 00 08 74 d8 8a f8 08 00 45 00  ..............E.	#
#	0010   00 6c 45 8d 00 00 80 11 73 98 c0 a8 00 05 c0 a8  .lE.....s.......	#
#	0020   00 06 0c 4f 27 10 00 58 bc 47 52 54 50 53 01 03  ...O'..X.GRTPS..	#
#	0030   00 00 00 00 00 00 00 01 09 01 02 19 3c 00 52 65  ............<.Re	#
#	0040   61 64 57 72 69 74 12 34 56 78 de ad ba be ba aa  adWrit.4Vx......	#
#	0050   aa ad 98 76 54 32 10 fe dc ba 2f 00 18 00 80 00  ...vT2..../.....	#
#	0060   00 01 12 34 56 78 00 11 22 33 44 55 66 77 88 99  ...4Vx.."3DUfw..	#
#	0070   aa bb cc dd ee ff 01 00 00 00                    ..........				#
#																																						#
#############################################################################

#############################################################################
# 															Packet 5																		#
#																																						#
#	0000   FF FF FF FF FF FF 00 08 74 d8 8a f8 08 00 45 00  ..............E.	#
#	0010   00 84 d5 d6 00 00 80 11 e3 36 c0 a8 00 05 c0 a8  .........6......	#
#	0020   00 06 0d 46 27 10 00 70 6f 47 52 54 50 53 01 03  ...F'..poGRTPS..	#
#	0030   00 00 00 00 00 00 00 01 09 01 02 19 54 00 52 65  ............T.Re	#
#	0040   61 64 57 72 69 74 12 34 56 78 de ad ba be ba aa  adWrit.4Vx......	#
#	0050   aa ad 98 76 54 32 10 fe dc ba 55 00 30 00 02 00  ...vT2....U.0...	#
#	0060   00 00 11 22 33 44 55 66 77 88 02 00 00 00 01 02  ..."3DUfw.......	#
#	0070   03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f 00 a1 a2  ................	#
#	0080   a3 a4 a5 a6 a7 a8 a9 aa ab ac ad ae af a0 01 00  ................	#
#	0090   00 00                                            ..								#
#																																						#
#############################################################################

#############################################################################
# 															Packet 6																		#
#																																						#
#	0000   FF FF FF FF FF FF 00 08 74 d8 8a f8 08 00 45 00  ..............E.	#
#	0010   00 58 1e e3 00 00 80 11 9a 56 c0 a8 00 05 c0 a8  .X.......V......	#
#	0020   00 06 0e 74 27 10 00 44 b0 96 52 54 50 53 01 03  ...t'..D..RTPS..	#
#	0030   00 00 00 00 00 00 00 01 09 01 02 19 54 00 52 65  ............T.Re	#
#	0040   61 64 57 72 69 74 12 34 56 78 de ad ba be ba aa  adWrit.4Vx......	#
#	0050   aa ad 98 76 54 32 10 fe dc ba 11 00 04 00 c8 a0  ...vT2..........	#
#	0060   00 05 01 00 00 00                                ......						#
#																																						#
#############################################################################

#############################################################################
# 															Packet 7																		#
#																																						#
#	0000   FF FF FF FF FF FF 00 08 74 d8 8a f8 08 00 45 00  ..............E.	#
#	0010   00 60 90 ed 00 00 80 11 28 44 c0 a8 00 05 c0 a8  .`......(D......	#
#	0020   00 06 05 93 27 10 00 4c d4 40 52 54 50 53 01 03  ....'..L.@RTPS..	#
#	0030   00 00 00 00 00 00 00 01 09 01 02 19 54 00 52 65  ............T.Re	#
#	0040   61 64 57 72 69 74 12 34 56 78 de ad ba be ba aa  adWrit.4Vx......	#
#	0050   aa ad 98 76 54 32 10 fe dc ba 50 00 0c 00 11 22  ...vT2....P...."	#
#	0060   33 44 55 66 77 88 99 aa bb cc 01 00 00 00        3DUfw.........		#
#																																						#
#############################################################################

#############################################################################
# 															Packet 8																		#
#																																						#
#	0000   FF FF FF FF FF FF 00 08 74 d8 8a f8 08 00 45 00  ..............E.	#
#	0010   00 70 d3 d4 00 00 80 11 e5 4c c0 a8 00 05 c0 a8  .p.......L......	#
#	0020   00 06 0c 1f 27 10 00 5c c5 f0 52 54 50 53 02 00  ....'..\..RTPS..	#
#	0030   00 00 00 00 00 00 00 01 09 01 12 34 56 78 02 1b  ...........4Vx..	#
#	0040   54 00 52 65 61 64 57 72 69 74 98 76 54 32 10 fe  T.ReadWrit.vT2..	#
#	0050   dc ba 12 34 56 78 de ad ba be 45 67 89 0a ba aa  ...4Vx....Eg....	#
#	0060   aa ad 10 fe dc ba 50 00 10 00 11 22 33 44 55 66  ......P...."3DUf	#
#	0070   77 88 99 aa bb cc dd ee ff de 01 00 00 00        w.............		#
#																																						#
#############################################################################

#############################################################################
# 															Packet 9																		#
#																																						#
#	0000   FF FF FF FF FF FF 00 08 74 d8 8a f8 08 00 45 00  ..............E.	#
#	0010   00 70 31 3a 00 00 80 11 87 e7 c0 a8 00 05 c0 a8  .p1:............	#
#	0020   00 06 0c 9b 27 10 00 5c be 74 52 54 50 53 02 00  ....'..\.tRTPS..	#
#	0030   00 00 00 00 00 00 00 01 09 01 12 34 56 78 02 1b  ...........4Vx..	#
#	0040   54 00 52 65 61 64 57 72 69 74 98 76 54 32 10 fe  T.ReadWrit.vT2..	#
#	0050   dc ba 12 34 56 78 de ad ba be 45 67 89 0a ba aa  ...4Vx....Eg....	#
#	0060   aa ad 10 fe dc ba 57 00 10 00 11 22 33 44 55 66  ......W...."3DUf	#
#	0070   77 88 99 aa bb cc dd ee ff de 01 00 00 00        w.............		#
#																																						#
#############################################################################

#############################################################################
# 															Packet 10																		#
#																																						#
#	0000   FF FF FF FF FF FF 00 08 74 d8 8a f8 08 00 45 00  ..............E.	#
#	0010   00 54 e0 c9 00 00 80 11 d8 73 c0 a8 00 05 c0 a8  .T.......s......	#
#	0020   00 06 0e 57 27 10 00 40 72 5e 52 54 50 53 02 00  ...W'..@r^RTPS..	#
#	0030   00 00 00 00 00 00 00 01 09 01 12 34 56 78 12 01  ...........4Vx..	#
#	0040   20 00 52 65 61 64 57 72 69 74 98 76 54 32 10 fe   .ReadWrit.vT2..	#
#	0050   dc ba 44 44 44 44 10 00 00 00 00 00 a5 5a 01 00  ..DDDD.......Z..	#
#	0060   00 00                                            ..								#
#																																						#
#############################################################################

#############################################################################
# 															Packet 11																		#
#																																						#
#	0000   FF FF FF FF FF FF 00 08 74 d8 8a f8 08 00 45 00  ..............E.	#
#	0010   00 64 8b 11 00 00 80 11 2e 1c c0 a8 00 05 c0 a8  .d..............	#
#	0020   00 06 10 66 27 10 00 50 77 ef 52 54 50 53 02 00  ...f'..Pw.RTPS..	#
#	0030   00 00 00 00 00 00 00 01 09 01 12 34 56 78 02 1b  ...........4Vx..	#
#	0040   54 00 52 65 61 64 57 72 69 74 98 76 54 32 10 fe  T.ReadWrit.vT2..	#
#	0050   dc ba 12 34 56 78 de ad ba be 45 67 89 0a ba aa  ...4Vx....Eg....	#
#	0060   aa ad 10 fe dc ba 51 00 04 00 de ad ba be 01 00  ......Q.........	#
#	0070   00 00                                            ..								#
#																																						#
#############################################################################

#############################################################################
# 															Packet 12																		#
#																																						#
#	0000   FF FF FF FF FF FF 00 08 74 d8 8a f8 08 00 45 00  ..............E.	#
#	0010   00 78 ce f7 00 00 80 11 ea 21 c0 a8 00 05 c0 a8  .x.......!......	#
#	0020   00 06 10 e2 27 10 00 64 d3 a2 52 54 50 53 02 00  ....'..d..RTPS..	#
#	0030   00 00 00 00 00 00 00 01 09 01 12 34 56 78 02 1b  ...........4Vx..	#	
#	0040   54 00 52 65 61 64 57 72 69 74 98 76 54 32 10 fe  T.ReadWrit.vT2..	#
#	0050   dc ba 12 34 56 78 de ad ba be 45 67 89 0a ba aa  ...4Vx....Eg....	#
#	0060   aa ad 10 fe dc ba 29 00 18 00 02 00 00 00 04 00  ......).........	#
#	0070   00 00 54 65 73 74 07 00 00 00 48 61 63 6b 69 6e  ..Test....Hackin	#
#	0080   67 00 01 00 00 00                                g.....						#	
#																																						#
#############################################################################

#############################################################################
# 															Packet 13																		#
#																																						#
#	0000   FF FF FF FF FF FF 00 08 74 d8 8a f8 08 00 45 00  ..............E.	#
#	0010   00 78 74 2a 00 00 80 11 44 ef c0 a8 00 05 c0 a8  .xt*....D.......	#
#	0020   00 06 11 e4 27 10 00 64 a3 a0 52 54 50 53 02 00  ....'..d..RTPS..	#
#	0030   00 00 00 00 00 00 00 01 09 01 12 34 56 78 02 1b  ...........4Vx..	#
#	0040   54 00 52 65 61 64 57 72 69 74 98 76 54 32 10 fe  T.ReadWrit.vT2..	#
#	0050   dc ba 12 34 56 78 de ad ba be 45 67 89 0a ba aa  ...4Vx....Eg....	#
#	0060   aa ad 10 fe dc ba 59 00 18 00 01 00 00 00 04 00  ......Y.........	#
#	0070   00 00 54 65 73 74 07 00 00 00 48 61 63 6b 69 6e  ..Test....Hackin	#
#	0080   67 00 01 00 00 00                                g.....						#
#																																						#
#############################################################################

#############################################################################
# 															Packet 14																		#
#																																						#
# 0000   FF FF FF FF FF FF 00 08 74 d8 8a f8 08 00 45 00  ..............E.	#
#	0010   00 ac ac bd 00 00 80 11 0c 28 c0 a8 00 05 c0 a8  .........(......	#
#	0020   00 06 12 41 27 10 00 98 93 77 52 54 50 53 02 00  ...A'....wRTPS..	#
#	0030   01 01 00 00 00 00 00 01 09 01 12 34 56 78 02 1b  ...........4Vx..	#
#	0040   78 00 52 65 61 64 57 72 69 74 98 76 54 32 10 fe  x.ReadWrit.vT2..	#
#	0050   dc ba 12 34 56 78 de ad ba be 45 67 89 0a ba aa  ...4Vx....Eg....	#
# 0060   aa ad 10 fe dc ba 06 80 4c 00 01 00 00 00 06 00  ........L.......	#
#	0070   00 00 46 69 6c 74 65 72 00 00 02 00 00 00 11 22  ..Filter......."	#
#	0080   33 44 55 66 77 88 99 aa bb cc dd ee ff 16 17 18  3DUfw...........	#
#	0090   19 20 21 22 23 24 01 02 03 04 05 06 07 08 09 10  . !"#$..........	#
#	00a0   11 12 13 14 15 16 17 18 19 20 21 22 23 24 03 00  ......... !"#$..	#
#	00b0   00 00 45 78 70 00 01 00 00 00                    ..Exp.....				#
#																																						#
#############################################################################

#############################################################################
# 															Packet 15																		#
#																																						#
#	0000   FF FF FF FF FF FF 00 08 74 d8 8a f8 08 00 45 00  ..............E.	#
#	0010   00 58 dd ea 00 00 80 11 db 4e c0 a8 00 05 c0 a8  .X.......N......	#
#	0020   00 06 12 7a 27 10 00 44 e7 50 52 54 50 53 01 03  ...z'..D.PRTPS..	#
#	0030   00 00 00 00 00 00 00 01 09 01 08 01 24 00 93 4e  ............$..N	#
#	0040   4e d4 d2 d4 15 05 00 00 00 00 10 00 00 00 00 00  N...............	#
#	0050   00 00 01 02 00 00 40 00 00 00 6f 6d 69 63 20 42  ......@...omic B	#
#	0060   6f 6f 01 00 00 00                                oo....						#
#																																						#
#############################################################################

#############################################################################
# 															Packet 16																		#
#																																						#
#	0000   FF FF FF FF FF FF 00 08 74 d8 8a f8 08 00 45 00  ..............E.	#
#	0010   00 4c f1 b2 00 00 80 11 c7 92 c0 a8 00 05 c0 a8  .L..............	#
#	0020   00 06 12 9b 27 10 00 38 be a3 52 54 50 53 02 00  ....'..8..RTPS..	#
#	0030   01 01 00 00 00 00 00 01 09 01 12 34 56 78 15 01  ...........4Vx..	#
#	0040   18 00 5a 7e 0c 00 93 4e 4e d4 d2 d4 15 05 00 00  ..Z~...NN.......	#
#	0050   00 00 10 00 00 00 01 00 00 00                    ..........				#
#																																						#
#############################################################################

#############################################################################
# 															Packet 17																		#
#																																						#
#	0000   FF FF FF FF FF FF 00 08 74 d8 8a f8 08 00 45 00  ..............E.	#
#	0010   00 78 1c 95 00 00 80 11 9c 84 c0 a8 00 05 c0 a8  .x..............	#
#	0020   00 06 12 c8 27 10 00 64 59 e6 52 54 50 53 02 00  ....'..dY.RTPS..	#
#	0030   01 01 00 00 00 00 00 01 09 01 12 34 56 78 02 1b  ...........4Vx..	#
#	0040   78 00 52 65 61 64 57 72 69 74 98 76 54 32 10 fe  x.ReadWrit.vT2..	#
#	0050   dc ba 12 34 56 78 de ad ba be 45 67 89 0a ba aa  ...4Vx....Eg....	#
#	0060   aa ad 10 fe dc ba 70 00 18 00 46 69 6c 74 65 72  ......p...Filter	#
#	0070   00 00 11 22 33 44 55 66 77 88 99 aa bb cc dd ee  ..."3DUfw.......	#
#	0080   ff de 01 00 00 00                                ......						#
#																																						#
#############################################################################

from scapy.all import *
import networkx as nx

import sys
eth_payloads = [
	b'\x45\x00\x00\x40\x0e\x0d\x00\x00\x80\x11\xab\x44\xc0\xa8\x00\05\c0\a8\00\06\09\be\27\10\00\2c\b7\f9\52\54\50\53\01\03\00\00\00\00\00\00\00\01\09\01\0c\01\10\00\c8\a0\00\05\01\00\01\06\12\34\56\78\de\ad\ba\be',
	b'\45\00\00\67\7b\40\00\00\80\11\3d\ea\c0\a8\00\05\c0\a8\00\06\0a\2c\27\10\00\53\5b\48\52\54\50\53\01\03\00\00\00\00\00\00\00\01\09\01\08\01\ed\58\93\4e\4e\d4\d2\d4\15\05\00\00\00\00\10\00\00\00\00\00\00\00\01\02\00\00\00\00\02\00\00\00\00\01\00\00\0f\00\00\00\43\6f\6d\69\63\20\42\6f\6f\6b\20\47\75\79\00\cd\07',
	b'45\00\00\38\a9\2f\00\00\80\11\10\2a\c0\a8\00\05\c0\a8\00\06\0b\2b\27\10\00\24\f1\95\52\54\50\53\01\03\00\00\00\00\00\00\00\01\09\01\09\00\00\08\c5\02\04\ec\ec\42\ee\92',
	b'45\00\00\6c\45\8d\00\00\80\11\73\98\c0\a8\00\05\c0\a8\00\06\0c\4f\27\10\00\58\bc\47\52\54\50\53\01\03\00\00\00\00\00\00\00\01\09\01\02\19\3c\00\52\65\61\64\57\72\69\74\12\34\56\78\de\ad\ba\be\ba\aa\aa\ad\98\76\54\32\10\fe\dc\ba\2f\00\18\00\80\00\00\01\12\34\56\78\00\11\22\33\44\55\66\77\88\99\aa\bb\cc\dd\ee\ff\01\00\00\00',
	b'45\00\00\84\d5\d6\00\00\80\11\e3\36\c0\a8\00\05\c0\a8\00\06\0d\46\27\10\00\70\6f\47\52\54\50\53\01\03\00\00\00\00\00\00\00\01\09\01\02\19\54\00\52\65\61\64\57\72\69\74\12\34\56\78\de\ad\ba\be\ba\aa\aa\ad\98\76\54\32\10\fe\dc\ba\55\00\30\00\02\00\00\00\11\22\33\44\55\66\77\88\02\00\00\00\01\02\03\04\05\06\07\08\09\0a\0b\0c\0d\0e\0f\00\a1\a2\a3\a4\a5\a6\a7\a8\a9\aa\ab\ac\ad\ae\af\a0\01\00\00\00',
	b'45\00\00\58\1e\e3\00\00\80\11\9a\56\c0\a8\00\05\c0\a8\00\06\0e\74\27\10\00\44\b0\96\52\54\50\53\01\03\00\00\00\00\00\00\00\01\09\01\02\19\54\00\52\65\61\64\57\72\69\74\12\34\56\78\de\ad\ba\be\ba\aa\aa\ad\98\76\54\32\10\fe\dc\ba\11\00\04\00\c8\a0\00\05\01\00\00\00',
	b'45\00\00\60\90\ed\00\00\80\11\28\44\c0\a8\00\05\c0\a8\00\06\05\93\27\10\00\4c\d4\40\52\54\50\53\01\03\00\00\00\00\00\00\00\01\09\01\02\19\54\00\52\65\61\64\57\72\69\74\12\34\56\78\de\ad\ba\be\ba\aa\aa\ad\98\76\54\32\10\fe\dc\ba\50\00\0c\00\11\22\33\44\55\66\77\88\99\aa\bb\cc\01\00\00\00',
	b'45\00\00\70\d3\d4\00\00\80\11\e5\4c\c0\a8\00\05\c0\a8\00\06\0c\1f\27\10\00\5c\c5\f0\52\54\50\53\02\00\00\00\00\00\00\00\00\01\09\01\12\34\56\78\02\1b\54\00\52\65\61\64\57\72\69\74\98\76\54\32\10\fe\dc\ba\12\34\56\78\de\ad\ba\be\45\67\89\0a\ba\aa\aa\ad\10\fe\dc\ba\50\00\10\00\11\22\33\44\55\66\77\88\99\aa\bb\cc\dd\ee\ff\de\01\00\00\00',
	b'45\\00\00\70\31\3a\00\00\80\11\87\e7\c0\a8\00\05\c0\a8\00\06\0c\9b\27\10\00\5c\be\74\52\54\50\53\02\00\00\00\00\00\00\00\00\01\09\01\12\34\56\78\02\1b\54\00\52\65\61\64\57\72\69\74\98\76\54\32\10\fe\dc\ba\12\34\56\78\de\ad\ba\be\45\67\89\0a\ba\aa\aa\ad\10\fe\dc\ba\57\00\10\00\11\22\33\44\55\66\77\88\99\aa\bb\cc\dd\ee\ff\de\01\00\00\00',
	b'45\00\00\54\e0\c9\00\00\80\11\d8\73\c0\a8\00\05\c0\a8\00\06\0e\57\27\10\00\40\72\5e\52\54\50\53\02\00\00\00\00\00\00\00\00\01\09\01\12\34\56\78\12\01\20\00\52\65\61\64\57\72\69\74\98\76\54\32\10\fe\dc\ba\44\44\44\44\10\00\00\00\00\00\a5\5a\01\00\00\00',
	b'45\00\00\64\8b\11\00\00\80\11\2e\1c\c0\a8\00\05\c0\a8\00\06\10\66\27\10\00\50\77\ef\52\54\50\53\02\00\00\00\00\00\00\00\00\01\09\01\12\34\56\78\02\1b\54\00\52\65\61\64\57\72\69\74\98\76\54\32\10\fe\dc\ba\12\34\56\78\de\ad\ba\be\45\67\89\0a\ba\aa\aa\ad\10\fe\dc\ba\51\00\04\00\de\ad\ba\be\01\00\00\00',
	b'45\00\00\78\ce\f7\00\00\80\11\ea\21\c0\a8\00\05\c0\a8\00\06\10\e2\27\10\00\64\d3\a2\52\54\50\53\02\00\00\00\00\00\00\00\00\01\09\01\12\34\56\78\02\1b\54\00\52\65\61\64\57\72\69\74\98\76\54\32\10\fe\dc\ba\12\34\56\78\de\ad\ba\be\45\67\89\0a\ba\aa\aa\ad\10\fe\dc\ba\29\00\18\00\02\00\00\00\04\00\00\00\54\65\73\74\07\00\00\00\48\61\63\6b\69\6e\67\00\01\00\00\00',
	b'45\00\00\78\74\2a\00\00\80\11\44\ef\c0\a8\00\05\c0\a8\00\06\11\e4\27\10\00\64\a3\a0\52\54\50\53\02\00\00\00\00\00\00\00\00\01\09\01\12\34\56\78\02\1b\54\00\52\65\61\64\57\72\69\74\98\76\54\32\10\fe\dc\ba\12\34\56\78\de\ad\ba\be\45\67\89\0a\ba\aa\aa\ad\10\fe\dc\ba\59\00\18\00\01\00\00\00\04\00\00\00\54\65\73\74\07\00\00\00\48\61\63\6b\69\6e\67\00\01\00\00\00',
	b'45\00\00\ac\ac\bd\00\00\80\11\0c\28\c0\a8\00\05\c0\a8\00\06\12\41\27\10\00\98\93\77\52\54\50\53\02\00\01\01\00\00\00\00\00\01\09\01\12\34\56\78\02\1b\78\00\52\65\61\64\57\72\69\74\98\76\54\32\10\fe\dc\ba\12\34\56\78\de\ad\ba\be\45\67\89\0a\ba\aa\aa\ad\10\fe\dc\ba\06\80\4c\00\01\00\00\00\06\00\00\00\46\69\6c\74\65\72\00\00\02\00\00\00\11\22\33\44\55\66\77\88\99\aa\bb\cc\dd\ee\ff\16\17\18\19\20\21\22\23\24\01\02\03\04\05\06\07\08\09\10\11\12\13\14\15\16\17\18\19\20\21\22\23\24\03\00\00\00\45\78\70\00\01\00\00\00',
	b'45\00\00\58\dd\ea\00\00\80\11\db\4e\c0\a8\00\05\c0\a8\00\06\12\7a\27\10\00\44\e7\50\52\54\50\53\01\03\00\00\00\00\00\00\00\01\09\01\08\01\24\00\93\4e\4e\d4\d2\d4\15\05\00\00\00\00\10\00\00\00\00\00\00\00\01\02\00\00\40\00\00\00\6f\6d\69\63\20\42\6f\6f\01\00\00\00',
	b'45\00\00\4c\f1\b2\00\00\80\11\c7\92\c0\a8\00\05\c0\a8\00\06\12\9b\27\10\00\38\be\a3\52\54\50\53\02\00\01\01\00\00\00\00\00\01\09\01\12\34\56\78\15\01\18\00\5a\7e\0c\00\93\4e\4e\d4\d2\d4\15\05\00\00\00\00\10\00\00\00\01\00\00\00',
	b'\x45\x00\x00\x78\x1C\x95\x00\x00\x80\x11\x9C\x84\xC0\xA8\x00\x05\xC0\xA8\x00\x06\x12\xC8\x27\x10\x00\x64\x59\xE6\x52\x54\x50\x53\x02\x00\x01\x01\x00\x00\x00\x00\x00\x01\x09\x01\x12\x34\x56\x78\x02\x1B\x78\x00\x52\x65\x61\x64\x57\x72\x69\x74\x98\x76\x54\x32\x10\xFE\xDC\xBA\x12\x34\x56\x78\xDE\xAD\xBA\xBE\x45\x67\x89\x0A\xBA\xAA\xAA\xAD\x10\xFE\xDC\xBA\x70\x00\x18\x00\x46\x69\x6C\x74\x65\x72\x00\x00\x11\x22\x33\x44\x55\x66\x77\x88\x99\xAA\xBB\xCC\xDD\xEE\xFF\xDE\x01\x00\x00\x00'
]


def read_topo():
    nb_hosts = 0
    nb_switches = 0
    links = []
    with open("topo.txt", "r") as f:
        line = f.readline()[:-1]
        w, nb_switches = line.split()
        assert(w == "switches")
        line = f.readline()[:-1]
        w, nb_hosts = line.split()
        assert(w == "hosts")
        for line in f:
            if not f: break
            a, b = line.split()
            links.append( (a, b) )
    return int(nb_hosts), int(nb_switches), links

def main():
    if len(sys.argv) != 1:
        print "Usage: send.py"
        print "For example: send.py"
        sys.exit(1)

    nb_hosts, nb_switches, links = read_topo()

    for eth_payload in eth_payloads:
        p = Ether(src = "00:00:00:00:00:01", type=0x0800)/eth_payload
        print p.show()
        sendp(p, iface = "s1-eth2")

if __name__ == '__main__':
    main()
